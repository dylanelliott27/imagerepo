(this.webpackJsonpimagerepo=this.webpackJsonpimagerepo||[]).push([[0],{163:function(e,t,a){e.exports=a(299)},168:function(e,t,a){},290:function(e,t,a){},299:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(14),l=a.n(c),i=(a(168),a(36)),o=a(39),u=a(305),m=a(309),s=a(310);var f=function(){var e=Object(n.useContext)(F),t=e.userInfo,a=e.logout;return r.a.createElement(u.a,{mode:"horizontal"},r.a.createElement(u.a.Item,{key:"home",icon:r.a.createElement(m.a,null)},r.a.createElement(o.b,{to:"/"},"Home")),!t.username&&r.a.createElement(u.a.Item,{key:"login",icon:r.a.createElement(s.a,null)},r.a.createElement(o.b,{to:"/login"},"Login")),!t.username&&r.a.createElement(u.a.Item,{key:"register",icon:r.a.createElement(s.a,null)},r.a.createElement(o.b,{to:"/register"},"Register")),t.username&&r.a.createElement(u.a.Item,{key:"upload",icon:r.a.createElement(s.a,null)},r.a.createElement(o.b,{to:"/upload"},"Upload")),t.username&&r.a.createElement(u.a.Item,{key:"myImages",icon:r.a.createElement(s.a,null)},r.a.createElement(o.b,{to:"/myimages"},"My Images")),t.username&&r.a.createElement(u.a.Item,{style:{float:"right"},key:"user",icon:r.a.createElement(s.a,null)},t.username),t.username&&r.a.createElement(u.a.Item,{style:{float:"right"},key:"money",icon:r.a.createElement(s.a,null)},"$",t.money),t.username&&r.a.createElement(u.a.Item,{onClick:function(){document.cookie="auth=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",a()},style:{float:"right"},key:"logout",icon:r.a.createElement(s.a,null)},"Log out"))},g=a(30),p=a(300),h=a(301),E=a(303),d=a(307),b=a(64);var y=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useContext)(F),o=l.updateUserInfo,u=l.loggedIn;return Object(n.useEffect)((function(){fetch("/api/imagelist",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){return c(e)})).catch((function(e){return console.error("issue fetching imagedata")}))}),[]),u?r.a.createElement(p.a,null,r.a.createElement(h.a,{span:22,offset:1},r.a.createElement("h1",{style:{textAlign:"center"}},"Marketplace"),r.a.createElement(E.b,{itemLayout:"vertical",size:"large",pagination:{onChange:function(e){console.log(e)},pageSize:5},dataSource:a,renderItem:function(e){return r.a.createElement(E.b.Item,{key:e.title,actions:[],extra:r.a.createElement("img",{width:272,alt:"logo",src:"/api/images/".concat(e.path)})},r.a.createElement(E.b.Item.Meta,{avatar:r.a.createElement(d.a,{src:e.avatar}),title:r.a.createElement("a",{href:e.href},e.ownerUsername),description:"$"+e.price}),e.isOwner?r.a.createElement(b.a,{type:"danger"},"You own this"):r.a.createElement(b.a,{onClick:function(t){return a=e.pictureID,void fetch("/api/purchasereq",{method:"POST",credentials:"include",body:JSON.stringify({pictureID:a})}).then((function(e){200===e.status&&fetch("/api/imagelist",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){o(),c(e)})).catch((function(e){return console.error("issue fetching imagedata")}))})).catch((function(e){return console.error("issue purchasing")}));var a},type:"primary"},"Purchase"))}}))):r.a.createElement(g.a,{to:"/login"})},O=a(67),j=a(34),v=a(302);var I=function(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useContext)(F).loggedIn,o=Object(n.useState)(!1),u=Object(i.a)(o,2),m=u[0],s=u[1],f=Object(n.useRef)(null);function p(e){Array.from(e.target.files).forEach((function(e){!function(e,t){t.readAsDataURL(e),t.addEventListener("load",(function(t){c((function(a){return Object(j.a)(Object(j.a)({},a),{},Object(O.a)({},e.name,{price:0,public:!0,data:t.target.result,tags:""}))}))}))}(e,new FileReader)}))}if(!l)return r.a.createElement(g.a,{to:"/login"});var h={labelCol:{span:6},wrapperCol:{span:14}};return m?r.a.createElement(g.a,{to:"/myimages"}):r.a.createElement(v.a,Object.assign({name:"validate_other"},h,{onFinish:function(e){for(var t=f.current.files,n=new FormData,r=0;r<t.length;r++){var c=Math.floor(124999*Math.random()+1);n.append(c,t[r]),n.append(c,JSON.stringify([a[t[r].name].public,a[t[r].name].price,a[t[r].name].tags]))}fetch("/api/uploadimg",{body:n,method:"POST",credentials:"include"}).then((function(e){200===e.status&&s(!0)})).catch((function(e){return alert("issue uploading the image")}))}}),r.a.createElement("h1",{style:{textAlign:"center",marginTop:"50px"}},"Upload a image"),r.a.createElement(v.a.Item,Object.assign({},h,{name:"Images",label:"Choose your images"}),r.a.createElement("input",{type:"file",ref:f,multiple:!0,onChange:function(e){return p(e)}})),r.a.createElement(v.a.Item,{wrapperCol:{span:12,offset:6}},r.a.createElement(b.a,{type:"primary",htmlType:"submit"},"Submit")),a&&Object.keys(a).map((function(e){return r.a.createElement("div",null,r.a.createElement("img",{key:e,style:{width:"150px",height:"100%"},src:a[e].data}),r.a.createElement("label",null,"Price"),r.a.createElement("input",{onChange:function(t){t.persist(),c((function(n){return Object(j.a)(Object(j.a)({},n),{},Object(O.a)({},e,Object(j.a)(Object(j.a)({},a[e]),{},{price:t.target.value})))}))}}),r.a.createElement("label",null,"Public"),r.a.createElement("select",{onChange:function(t){t.persist(),c((function(n){return Object(j.a)(Object(j.a)({},n),{},Object(O.a)({},e,Object(j.a)(Object(j.a)({},a[e]),{},{public:t.target.value})))}))}},r.a.createElement("option",{value:"true"},"True"),r.a.createElement("option",{value:"false"},"False")),r.a.createElement("label",null,"Tags(comma seperated)"),r.a.createElement("input",{onChange:function(t){t.persist(),c((function(n){return Object(j.a)(Object(j.a)({},n),{},Object(O.a)({},e,Object(j.a)(Object(j.a)({},a[e]),{},{tags:t.target.value})))}))}}))})))},S=a(306),w=a(308),C=a(311),k=a(312);var x=function(){var e=Object(n.useState)(),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(),o=Object(i.a)(l,2),u=o[0],m=o[1],s=Object(n.useContext)(F),f=s.login;return s.loggedIn?r.a.createElement(g.a,{to:"/"}):r.a.createElement(p.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},r.a.createElement(h.a,{span:5},r.a.createElement("h1",null,"Login"),r.a.createElement(v.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:function(e){return f(a,u)}},r.a.createElement(v.a.Item,{name:"username",rules:[{required:!0,message:"Please input your Username!"}]},r.a.createElement(S.a,{onChange:function(e){return c(e.target.value)},prefix:r.a.createElement(C.a,{className:"site-form-item-icon"}),placeholder:"Username"})),r.a.createElement(v.a.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}]},r.a.createElement(S.a,{onChange:function(e){return m(e.target.value)},prefix:r.a.createElement(k.a,{className:"site-form-item-icon"}),type:"password",placeholder:"Password"})),r.a.createElement(v.a.Item,null,r.a.createElement(v.a.Item,{name:"remember",valuePropName:"checked",noStyle:!0},r.a.createElement(w.a,null,"Remember me")),r.a.createElement("a",{className:"login-form-forgot",href:""},"Forgot password")),r.a.createElement(v.a.Item,null,r.a.createElement(b.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")))))};var P=function(){var e=Object(n.useState)(),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(),o=Object(i.a)(l,2),u=o[0],m=o[1],s=Object(n.useState)(),f=Object(i.a)(s,2),E=f[0],d=f[1],y=Object(n.useContext)(F),O=y.login,j=y.loggedIn;return E||j?r.a.createElement(g.a,{to:"/"}):r.a.createElement(p.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},r.a.createElement(h.a,{span:5},r.a.createElement("h1",null,"Register"),r.a.createElement(v.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:function(e){fetch("/api/register",{method:"POST",credentials:"include",body:JSON.stringify({username:a,password:u})}).then((function(e){if(console.log(e),200===e.status)return e.json()})).then((function(e){O(e.username,null,!0,e.money),d(!0)})).catch((function(e){return alert("issue registering")}))}},r.a.createElement(v.a.Item,{name:"username",rules:[{required:!0,message:"Please input your Username!"}]},r.a.createElement(S.a,{onChange:function(e){return c(e.target.value)},prefix:r.a.createElement(C.a,{className:"site-form-item-icon"}),placeholder:"Username"})),r.a.createElement(v.a.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}]},r.a.createElement(S.a,{onChange:function(e){return m(e.target.value)},prefix:r.a.createElement(k.a,{className:"site-form-item-icon"}),type:"password",placeholder:"Password"})),r.a.createElement(v.a.Item,null,r.a.createElement(v.a.Item,{name:"remember",valuePropName:"checked",noStyle:!0},r.a.createElement(w.a,null,"Remember me")),r.a.createElement("a",{className:"login-form-forgot",href:""},"Forgot password")),r.a.createElement(v.a.Item,null,r.a.createElement(b.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")))))},T=(a(290),a(159)),N=a(88),U=a(304),D=N.a.Option;var L=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useContext)(F).loggedIn,o=Object(n.useState)(!1),u=Object(i.a)(o,2),m=u[0],s=u[1],f=Object(n.useState)({}),y=Object(i.a)(f,2),O=y[0],v=y[1];return Object(n.useEffect)((function(){fetch("/api/userimages",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){return c(e)})).catch((function(e){return alert("unable to fetch user specific images")}))}),[]),l?r.a.createElement(p.a,null,r.a.createElement(h.a,{span:22,offset:1},r.a.createElement("h1",{style:{textAlign:"center"}},"Your Images"),r.a.createElement(E.b,{itemLayout:"vertical",size:"large",pagination:{onChange:function(e){console.log(e)},pageSize:5},dataSource:a,renderItem:function(e){return r.a.createElement(E.b.Item,{key:e.title,actions:[],extra:r.a.createElement("img",{width:272,alt:"logo",src:"/api/images/".concat(e.path)})},r.a.createElement(E.b.Item.Meta,{avatar:r.a.createElement(d.a,{src:e.avatar}),title:r.a.createElement("a",{href:e.href},e.ownerUsername),description:"$"+e.price}),e.public?r.a.createElement("p",null,"This item is listed on the marketplace"):r.a.createElement("p",null,"This item is not listed on the marketplace"),r.a.createElement(b.a,{onClick:function(t){return a={id:e.pictureID,price:e.price,public:e.public},v(a),void s(!0);var a},type:"primary"},"EDIT"),r.a.createElement(b.a,{onClick:function(t){return n=e.pictureID,void fetch("/api/deleteimg",{method:"POST",credentials:"include",body:JSON.stringify({pictureID:n})}).then((function(e){200===e.status&&c((function(e){console.log(e);for(var t=Object(T.a)(a),r=0;r<t.length;r++)t[r].pictureID===n&&t.splice(r,1);return t}))}));var n},type:"danger"},"DELETE"))}}),r.a.createElement(U.a,{title:"Edit image details..",visible:m,onOk:function(){s(!1),fetch("/api/editimg",{method:"POST",credentials:"include",body:JSON.stringify(O)}).then((function(e){200===e.status&&fetch("/api/userimages",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){return c(e)})).catch((function(e){return alert("unable to fetch user specific images")}))})).catch((function(e){return alert("unable to edit image")})),v({})},onCancel:function(){s(!1),v({})}},r.a.createElement("label",null,"Price"),r.a.createElement(S.a,{onChange:function(e){return v(Object(j.a)(Object(j.a)({},O),{},{price:e.target.value}))},value:O.price,placeholder:"Basic usage"}),r.a.createElement("label",null,"Public"),r.a.createElement(N.a,{key:O.public,defaultValue:1==O.public?"true":"false",style:{width:120},onChange:function(e){return v(Object(j.a)(Object(j.a)({},O),{},{public:"true"==e?1:0}))}},r.a.createElement(D,{value:"true"},"True"),r.a.createElement(D,{value:"false"},"False"))))):r.a.createElement(g.a,{to:"/login"})},F=Object(n.createContext)({user:{},login:function(){},loggedIn:!1,getUserInfo:function(){},logout:function(){}});var J=function(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(!1),u=Object(i.a)(l,2),m=u[0],s=u[1];return Object(n.useEffect)((function(){fetch("/api/userinfo",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){c({username:e.username,money:e.money}),s(!0)})).catch((function(e){return console.log("not logged in")}))}),[]),r.a.createElement(F.Provider,{value:{userInfo:a,login:function(e,t,a,n){if(a)return s(!0),void c({username:e,money:n});fetch("/api/login",{method:"POST",credentials:"include",body:JSON.stringify({username:e,password:t})}).then((function(e){if(200===e.status)return e.json()})).then((function(e){c({username:e.username,money:e.money}),s(!0)})).catch((function(e){return alert("issue logging in")}))},loggedIn:m,updateUserInfo:function(){fetch("/api/userinfo",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){return c(e)}))},logout:function(){s(!1),c({})}}},r.a.createElement(o.a,null,r.a.createElement(f,null),r.a.createElement(g.d,null,r.a.createElement(g.b,{path:"/",exact:!0},r.a.createElement(y,null)),r.a.createElement(g.b,{path:"/upload"},r.a.createElement(I,null)),r.a.createElement(g.b,{path:"/login"},r.a.createElement(x,null)),r.a.createElement(g.b,{path:"/register"},r.a.createElement(P,null)),r.a.createElement(g.b,{path:"/myimages"},r.a.createElement(L,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[163,1,2]]]);
//# sourceMappingURL=main.39c0f532.chunk.js.map